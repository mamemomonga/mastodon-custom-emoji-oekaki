<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><title>カスタム絵文字でお絵かきツール</title><meta name="viewport" content="width=430"><link rel="stylesheet" href="./assets/font-awesome/css/font-awesome.min.css"><script type="text/javascript" src="./assets/jquery.min.js"></script><style type="text/css">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}table{border-collapse:collapse;border-spacing:0}html{height:100%}body{font-size:12px;font-family:sans-serif;background-color:#282c37;color:#FFFFFF;height:100%}a{color:#AAAAFF}h1{background-color:#444b5d;padding:5px;margin:2px;font-size:18px;font-weight:bold}.container_intro{display:none;text-align:center;background-color:#000000;padding:20px}.container_intro h1{padding:20px;margin:5px 5px 20px 5px}.container_intro h2{font-size:20px;margin:10px}.container_intro h3{font-size:14px;margin:10px;padding:10px}.container_loading{display:none;text-align:center;background-color:#000000;font-size:32px;padding:20px}.container_loading h1{padding:20px;margin:5px 5px 20px 5px}.instance_info{background-color:#000000;font-size:12px;vertical-align:middle;text-align:center}#instance_info_domain{font-size:32px;height:38px;width:300px;margin:0px}#instance_info_submit{font-size:28px;width:140px;height:38px;border:1px solid #000000;margin:0px;padding:0px}.container_main{display:none;background-color:#000000}.cont_left{float:left;height:645px}#tiles{width:418px;height:428px;padding:4px 4px 4px 4px;background-color:#393f4f}#tiles img{cursor:pointer}#result{width:414px;height:130px;padding:5px;font-size:12px;background-color:#FFFFFF}.cont_ret_ctrl{padding:5px;background-color:#666666}.cont_ret_ctrl .left{float:left;vertical-align:middle}.cont_ret_ctrl .cont_klg_btn{border:1px solid red}.cont_ret_ctrl .right{text-align:right}.cont_result_count{padding:5px;height:18px;background-color:#000000}.cont_right{background-color:#000000}.cont_right_top{overflow:hidden;padding:5px;margin:0px;background-color:#000000;font-size:14px;line-height:14px;vertical-align:middle}#instance_domain{font-weight:bold;text-decoration:underline;cursor:pointer}#selected_shortname{text-decoration:underline;cursor:pointer}.cont_right_top .left{float:left;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;margin:5px 0 0 5px}.cont_right_top .left .minibt{cursor:pointer}.cont_right_top .right{text-align:right}#text_search{width:110px}#bt_search_clear{cursor:pointer;margin:0px 10px 0 0}#instance_domain{margin:0 5px 0 5px}#selected_shortname{margin:0 5px 0 5px}#emoji_palette{height:600px;padding:5px;margin:0px;overflow-y:scroll;border:2px solid #000000;background-color:#393f4f}#emoji_palette img{cursor:pointer}.bottom{font-size:10px;padding:10px;text-align:center;background-color:#222222}.bottom .fa{font-size:18px}.bottom a{color:#FFFFFF;text-decoration:none}</style></head><body><div class="container_intro"><h1>カスタム絵文字でお絵かきツール</h1><div class="instance_info"><h2>インスタンス</h2><div class="instance_info"><input type="text" id="instance_info_domain" placeholder="mstdn.jp" size="24">　 <input type="submit" id="instance_info_submit" value=" 開 始 "><br></div><h3>カスタム絵文字APIが使用でき、:blank: 絵文字が定義されている必要があります。</h3></div></div><div class="container_loading"><h1>カスタム絵文字でお絵かきツール</h1>絵文字情報をロード中...</div><div class="container_main"><h1><span id="instance_domain"></span> カスタム絵文字でお絵かきツール</h1><div class="cont_left"><div id="tiles"></div><textarea id="result"></textarea><div class="cont_ret_ctrl"><div class="left"><input type="button" id="bt_ret_copy" value="コピー"> <input type="button" id="bt_ret_share" value="シェア"> | <input type="button" id="bt_load" value="読み込み"> <span class="emojimoji_btn"></span></div><div class="right"><input type="button" id="bt_reset" value="リセット"></div><div style="clear: both"></div></div><div class="cont_result_count">文字数: <span id="result_count">0</span></div></div><div class="cont_right"><div class="cont_right_top"><div class="left"><span id="btn_blank" class="minibt"><i class="fa fa-square fa-x2" aria-hidden="true"></i></span> <span id="btn_left" class="minibt"><i class="fa fa-arrow-circle-left fa-x2" aria-hidden="true"></i></span> <span id="btn_right" class="minibt"><i class="fa fa-arrow-circle-right fa-x2" aria-hidden="true"></i></span> <span id="btn_up" class="minibt"><i class="fa fa-arrow-circle-up fa-x2" aria-hidden="true"></i></span> <span id="btn_down" class="minibt"><i class="fa fa-arrow-circle-down fa-x2" aria-hidden="true"></i></span> <span id="selected_shortname">-</span></div><div class="right"><input type="text" id="text_search" placeholder="フィルタ"> <span id="bt_search_clear"><i class="fa fa-window-close" aria-hidden="true"></i></span></div><div style="clear: both"></div></div></div><div id="emoji_palette"></div></div><div style="clear:both"></div><div class="bottom"><a href="https://github.com/mamemomonga/mastodon-custom-emoji-oekaki" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a>　 <a href="https://theboss.tech/@mamemomonga" target="_blank"><i class="fa fa-child" aria-hidden="true"></i></a> 　#109 　　<a href="https://github.com/mamemomonga/mastodon-custom-emoji-oekaki/blob/master/MANUAL.md" target="_blank">使い方はこちら</a></div><script type="text/javascript">// <![CDATA[
!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.r(e);var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,o;return e=t,(i=[{key:"regex_escape",value:function(t){return t.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}},{key:"shortcode2elm",value:function(){var t={};return $("#emoji_palette img").each((function(e,i){t[i.dataset.shortcode]=i})),t}}])&&n(e.prototype,i),o&&n(e,o),t}();function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}var c=function(){function t(e){s(this,t),this.startup_configs=e,this.container=$(".cont_ret_ctrl .left .emojimoji_btn"),this.cb=function(){},this.init()}return a(t,[{key:"init",value:function(){var t=this;for(var e in this.container.empty(),this.ems=[],this.startup_configs)this.ems[e]=new l((function(e){t.cb(e)}),this.startup_configs[e])}},{key:"set_apply_callback",value:function(t){this.cb=t}},{key:"load",value:function(t){var e=this;for(var i in t.each((function(t,i){var n=i.dataset.shortcode;for(var o in e.ems){var s=e.ems[o],r=n.match(s.re_shortcode);r&&(n==s.icon.sc&&(s.icon.url=i.src),s.emojis[parseInt(r[1],16)]=n)}})),this.ems){var n=this.ems[i];Object.keys(n.emojis).length>0&&(n.icon.jq=$("<img>",{src:n.icon.url,css:{"vertical-align":"middle","object-fit":"contain",width:24,height:24}}),function(t){t.icon.jq.on("click",(function(e){t.convert()}))}(n),this.container.append(n.icon.jq))}}}]),t}(),l=function(){function t(e,i){s(this,t),this.prefix=i.prefix,this.h2k=!!i.h2k,this.icon={sc:i.icon,jq:void 0,url:""},this.re_shortcode=new RegExp("^"+this.prefix+"([0-9a-f]{4})$"),this.re_emojimoji=new RegExp(":"+this.prefix+"([0-9a-f]{4}):","mg"),this.jq_textarea=$("#result"),this.emojis={},this.callback=e,this.text=""}return a(t,[{key:"convert",value:function(){this.text=this.jq_textarea.val(),this.text.match(this.re_emojimoji)?this.decode():this.encode()}},{key:"decode",value:function(){this.jq_textarea.val(this.text.replace(this.re_emojimoji,(function(t,e){return String.fromCodePoint(parseInt(e,16))})))}},{key:"encode",value:function(){for(var t,e=this,i=this.text.split(/\r\n|\r|\n/),n=function(t){return parseInt(t,16)},o=[],s=0;s<i.length;s++){var r=[];for(var a in i[s]){var c=i[s].charCodeAt(a);c==n("0020")||c==n("3000")?r.push("blank"):this.h2k&&c>=n("3041")&&c<=n("3093")?r.push((t=c+96,e.emojis[t]?e.emojis[t]:"blank")):this.emojis[c]&&r.push(this.emojis[c])}o[s]=r}this.callback(o)}}]),t}();function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=11,this.height=11,this.util=new o,this.emojimojis=new c([{prefix:"klg",icon:"klg2640",h2k:!0},{prefix:"nrk",icon:"nrk30ca",h2k:!0}])}var e,i,n;return e=t,(i=[{key:"init",value:function(){var t=this;if(window.location.search){var e=window.location.search;window.location.href=window.location.href.replace(new RegExp(this.util.regex_escape(e)),"")+"#"+e.substring(1)}this.emojifetch_active=!1,this.emojimojis.set_apply_callback((function(e){t.tiles_reset();for(var i=0;i<t.height;i++){var n=[];if(e[i]){for(var o=0;o<t.width;o++)n[o]=e[i][o]||"blank";t.tiles_sc[i]=n}}t.tiles_from_sc()})),$("#instance_domain").on("click",(function(){t.reset(),t.emojimojis.init()})),$("#selected_shortname").on("click",(function(){t.selected_idom&&window.open(t.selected_idom.src)})),$("#bt_search_clear").on("click",(function(){$("#text_search").val("")})),$("#bt_ret_copy").on("click",(function(){$("#result").focus().select(),document.execCommand("copy")})),$("#bt_ret_share").on("click",(function(){window.open("https://"+t.instance_domain+"/share?text="+encodeURI($("#result").val()))})),$("#bt_reset").on("click",(function(){t.tiles_reset()})),$("#bt_load").on("click",(function(){t.tiles_load()})),$("#btn_left").on("click",(function(){t.tiles_move("left")})),$("#btn_right").on("click",(function(){t.tiles_move("right")})),$("#btn_up").on("click",(function(){t.tiles_move("up")})),$("#btn_down").on("click",(function(){t.tiles_move("down")})),$("#btn_blank").on("click",(function(){t.emoji_palette_select(t.util.shortcode2elm().blank)})),$("#instance_info_submit").on("click",(function(){t.emojifetch_active||t.emojifetch_start()}))}},{key:"run",value:function(){this.init();var t=window.location.hash.substring(1)||"";if(t)return $("#instance_info_domain").val(t),void(this.emojifetch_active||this.emojifetch_start());this.switch_show_container("intro")}},{key:"switch_show_container",value:function(t){var e=["main","loading","intro"];for(var i in e){var n=e[i];n==t?$(".container_"+n).show():$(".container_"+n).hide()}}},{key:"reset",value:function(){this.switch_show_container("intro")}},{key:"emojifetch_start",value:function(){var t=this;this.emojifetch_active=!0,this.switch_show_container("loading"),this.instance_domain=$("#instance_info_domain").val(),$.ajax({type:"GET",url:"https://"+this.instance_domain+"/api/v1/custom_emojis",success:function(e){t.emojifetch_active=!1,t.emojifetch_success(e)},error:function(e,i,n){t.emojifetch_active=!1,t.switch_show_container("intro"),alert("取得失敗")}})}},{key:"emojifetch_success",value:function(t){window.location.hash=this.instance_domain,$("#instance_domain").text(this.instance_domain),this.emoji_palette(t),this.tiles(),this.switch_show_container("main")}},{key:"search_update",value:function(){var t=$("#text_search").val();t!=this.prev_keyword&&(""==t?$("#emoji_palette img").each((function(t,e){$(e).show()})):$("#emoji_palette img").each((function(e,i){-1!=i.dataset.shortcode.search(t)?$(i).show():$(i).hide()})),this.prev_keyword=t)}},{key:"tiles_reset",value:function(){var t=this,e=this.blank_idom.src;$("#tiles img").each((function(i,n){n.src=e,t.tiles_sc[n.dataset.y][n.dataset.x]="blank"})),this.result()}},{key:"tiles_update",value:function(t){var e=this;this.tiles_reset(),$("#tiles img").each((function(i,n){var o=n.dataset.x,s=n.dataset.y;if(t[s]&&t[s][o]){var r=t[s][o];n.src=r.src,n.dataset.shortcode=r.dataset.shortcode,e.tiles_sc[n.dataset.y][n.dataset.x]=r.dataset.shortcode}})),this.result()}},{key:"tiles_from_sc",value:function(){for(var t=this.util.shortcode2elm(),e=[],i=0;i<this.height;i++){for(var n=[],o=0;o<this.width;o++)n[o]=t[this.tiles_sc[i][o]];e.push(n)}this.tiles_update(e)}},{key:"tiles_move",value:function(t){var e=this.tiles_sc;if("left"==t)for(var i in e)e[i].push(e[i].shift());if("right"==t)for(var n in e)e[n].unshift(e[n].pop());"up"==t&&e.push(e.shift()),"down"==t&&e.unshift(e.pop()),this.tiles_from_sc()}},{key:"tiles",value:function(){var t=this;this.tiles_sc=[],$("#tiles").text("");for(var e=0;e<this.height;e++){for(var i=[],n=0;n<this.width;n++){var o=$(this.blank_idom).clone();o.css({border:"2px solid #333333",margin:"1px"}),$(o).attr({"data-x":n,"data-y":e}),$("#tiles").append(o),i[n]="blank"}$("#tiles").append($("<br>")),this.tiles_sc[e]=i}$("#tiles img").on("click",(function(e){var i=e.target,n=i.dataset.x,o=i.dataset.y;t.selected_idom&&(i.src==t.selected_idom.src?($(i).attr({src:t.blank_idom.src}),t.tiles_sc[o][n]="blank"):($(i).attr({src:t.selected_idom.src}),t.tiles_sc[o][n]=t.selected_idom.dataset.shortcode),t.result())})),this.search_update_interval&&clearInterval(this.search_update_interval),this.search_update_interval=setInterval((function(){t.search_update()}),500)}},{key:"tiles_load",value:function(){for(var t=this.util.shortcode2elm(),e=$("#result").val().split(/\r\n|\r|\n/),i=[],n=0;n<(e.length>this.height?this.height:e.length);n++){for(var o=e[n].split(/\u200B| /),s=[],r=0;r<(o.length>this.width?this.width:o.length);r++){var a=t[o[r].replace(/^:/,"").replace(/:$/,"")];a&&(s[r]=a)}i[n]=s}this.tiles_update(i)}},{key:"emoji_palette",value:function(t){var e=this;$("#emoji_palette").text(""),t.sort((function(t,e){return t.shortcode<e.shortcode?-1:t.shortcode>e.shortcode?1:0}));for(var i=0;i<t.length;i++){var n=$("<img>",{src:t[i].url,"data-shortcode":t[i].shortcode,css:{border:"2px solid rgb(57, 63, 79)","object-fit":"contain",width:32,height:32}});$("#emoji_palette").append(n),"blank"==t[i].shortcode&&(this.blank_idom=n[0])}this.blank_idom||alert("このインスタンスには :blank: がないため使用できません"),$("#emoji_palette img").on("click",(function(t){e.emoji_palette_select(t.target)})),this.emojimojis.load($("#emoji_palette img"))}},{key:"emoji_palette_select",value:function(t){t!=this.selected_idom&&($("#selected_shortname").text(":"+t.dataset.shortcode+":"),$(t).css("border","2px solid #FFFFFF"),this.selected_idom=t,this.prev_selected_idom&&$(this.prev_selected_idom).css("border","2px solid rgb(57, 63, 79)"),this.prev_selected_idom=t)}},{key:"result",value:function(){for(var t=[],e=!1,i=this.height-1;i>=0;i--){for(var n=[],o=!1,s=this.width-1;s>=0;s--){var r=":"+this.tiles_sc[i][s]+":";":blank:"!=r&&(o=!0),o&&n.push(r)}n.length>0?e=!0:n.push("​"),e&&t.push(n.reverse())}for(var a=[],c=t.length-1;c>=0;c--)a.push(t[c].join("​"));var l=a.join("\n"),h=l.length,u="#000000";h>500&&(u="#FF0000"),$(".cont_result_count").css("background-color",u),$("#result_count").text(h),$("#result").val(l)}}])&&h(e.prototype,i),n&&h(e,n),t}();$((function(){(new u).run()}))}]);
// ]]></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-109885867-1"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-109885867-1');</script></body></html>